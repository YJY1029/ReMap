function rslt = AlgoReMapping_nonfit(num)
%ALGOREMAPPING opmitized method for range mapping
%   After figuring out coefficients by fitting, we apply them to the
%   remapping method. This function calculates one result each time. 

fid = fopen('FindCoefficients.txt', 'r'); 
coef = fscanf(fid, '%f', [2, 41]); 

[k, m] = KeyValues(num); 

node = [0,0.00625000000000000,0.0125000000000000,0.0187500000000000,0.0250000000000000,0.0312500000000000,0.0375000000000000,0.0437500000000000,0.0500000000000000,0.0562500000000000,0.0625000000000000,0.0687500000000000,0.0750000000000000,0.100000000000000,0.225000000000000,0.250000000000000,0.257812500000000,0.265625000000000,0.273437500000000,0.281250000000000,0.289062500000000,0.296875000000000,0.304687500000000,0.312500000000000,0.320312500000000,0.328125000000000,0.335937500000000,0.343750000000000,0.375000000000000,0.500000000000000,0.508928571428571,0.517857142857143,0.526785714285714,0.535714285714286,0.571428571428571,0.750000000000000,0.760416666666667,0.770833333333333,0.781250000000000,0.791666666666667,0.833333333333333,1]; 

if m == 0
    n = 1; 
elseif find(node == m) 
    n = find(m <= node, 1); 
else
    n = find(m <= node, 1)-1;
end

m_r = coef(1, n)*m + coef(2, n); 

fclose('all');

m_16 = floor(m_r * 2^27) / 2^27; 
rslt = m_16 + k; 

end